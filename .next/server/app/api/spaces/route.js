"use strict";(()=>{var e={};e.id=1385,e.ids=[1385],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},24356:(e,t,r)=>{let a;r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{GET:()=>u,dynamic:()=>d});var n=r(49303),i=r(88716),o=r(60670);a=new(r(53524)).PrismaClient;var p=r(87070);let d="force-dynamic";async function u(e){try{let{searchParams:t}=new URL(e.url),r=t.get("brandId"),s=t.get("mediaItemTypeId"),n=(await a.mediaSpace.findMany({where:{store:r?{brandId:parseInt(r)}:void 0,mediaItem:s?{mediaItemTypeId:parseInt(s)}:void 0},include:{mediaItem:!0,store:!0,leases:{where:{AND:[{status:{name:{not:"Completado"}}},{endDate:{gte:new Date}}]}}}})).map(e=>{let t=e.leases.length,r=e.mediaItem.capacity,a=r-t;return{...e,availableSlots:a,isAtCapacity:a<=0,currentCapacity:`${t}/${r}`}});return p.NextResponse.json(n)}catch(e){return console.error("Error fetching spaces:",e),p.NextResponse.json({error:"Failed to fetch spaces"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/spaces/route",pathname:"/api/spaces",filename:"route",bundlePath:"app/api/spaces/route"},resolvedPagePath:"/Users/joeym13/Documents/GitHub/ash/app/api/spaces/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:h}=c,y="/api/spaces/route";function g(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:l})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972],()=>r(24356));module.exports=a})();