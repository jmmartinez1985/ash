"use strict";(()=>{var e={};e.id=6593,e.ids=[6593],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},41281:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>D,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g});var o={};t.r(o),t.d(o,{GET:()=>u,POST:()=>l});var n=t(49303),s=t(88716),a=t(60670),i=t(87070),d=t(72331);async function l(e){try{let r=await e.json();if(console.log("Received store data:",r),!r.name||!r.location||!r.brandId)return i.NextResponse.json({error:"Missing required fields"},{status:400});let t=await d._.store.create({data:{name:r.name,location:r.location,brandId:r.brandId,mediaSpaces:{create:[]}}});return console.log("Created store:",t),i.NextResponse.json(t)}catch(r){let e=r instanceof Error?r.message:"Unknown error";return console.log("Error creating store:",e),i.NextResponse.json({error:"Failed to create store",message:e},{status:500})}}async function u(e){try{let{searchParams:r}=new URL(e.url),t=r.get("brandId");console.log("\n=== STORES API CALLED ==="),console.log("\uD83D\uDD0D URL:",e.url),console.log("\uD83D\uDD0D brandIdParam:",t,"type:",typeof t);let o=t?parseInt(t,10):NaN;if(console.log("\uD83D\uDD0D Parsed brandId:",o,"type:",typeof o),isNaN(o)){console.log("\uD83D\uDCCB No valid brandId, returning ALL stores");let e=await d._.store.findMany({include:{mediaSpaces:{include:{mediaItem:{include:{mediaItemType:!0}},leases:{where:{endDate:{gte:new Date}}}}},brand:!0}});return console.log(`ðŸ“‹ Found ${e.length} total stores`),i.NextResponse.json(e)}let n=await d._.brand.findUnique({where:{id:o},select:{id:!0,name:!0}});if(console.log("\uD83C\uDFE2 Found brand:",JSON.stringify(n,null,2)),!n)return console.log("âŒ No brand found for brandId:",o),i.NextResponse.json([]);if(1===n.id){console.log("\uD83D\uDD04 Brand is Novey y Cochez, fetching stores for brands 2 and 3");let e=await d._.store.findMany({where:{brandId:{in:[2,3]}},include:{mediaSpaces:{include:{mediaItem:{include:{mediaItemType:!0}},leases:{where:{endDate:{gte:new Date}}}}},brand:!0}});return console.log(`âœ… Found ${e.length} stores for Novey y Cochez`),i.NextResponse.json(e)}console.log("\uD83C\uDFAF Filtering by specific brandId:",o);let s=await d._.store.findMany({where:{brandId:o},include:{mediaSpaces:{include:{mediaItem:{include:{mediaItemType:!0}},leases:{where:{endDate:{gte:new Date}}}}},brand:!0}});return console.log(`âœ… Found ${s.length} stores for brand ${o}`),i.NextResponse.json(s)}catch(e){return console.error("âŒ Error in GET /stores:",e),i.NextResponse.json({error:"Failed to fetch stores"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/stores/route",pathname:"/api/stores",filename:"route",bundlePath:"app/api/stores/route"},resolvedPagePath:"/Users/joeym13/Documents/GitHub/ash/app/api/stores/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:m}=c,D="/api/stores/route";function f(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},72331:(e,r,t)=>{t.d(r,{_:()=>n});var o=t(53524);let n=globalThis.prisma??new o.PrismaClient({log:["query"]})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[9276,5972],()=>t(41281));module.exports=o})();